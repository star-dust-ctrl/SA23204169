<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Huiyang Peng" />


<title>Homework-2023.9.19</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework-2023.9.19</h1>
<h4 class="author">Huiyang Peng</h4>
<h4 class="date">2023-9-18</h4>



<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># load plot library</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a><span class="fu">library</span>(ggplot2)</span></code></pre></div>
<div id="blackboard-question" class="section level1">
<h1>Blackboard Question</h1>
<div id="restate" class="section level2">
<h2>Restate</h2>
<p>利用逆变换法复现函数<code>sample</code>的部分功能<code>(replace = TRUE)</code>。</p>
</div>
<div id="implementation" class="section level2">
<h2>Implementation</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># implement of sample() when replace = TRUE</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>sample.me <span class="ot">&lt;-</span> <span class="cf">function</span>(x, size, <span class="at">prob =</span> <span class="cn">NULL</span>){</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>  <span class="cf">if</span>(<span class="sc">!</span><span class="fu">is.null</span>(prob)){</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a>    cump <span class="ot">=</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>      prob <span class="ot">=</span> <span class="fu">rep</span>(<span class="dv">1</span><span class="sc">/</span><span class="fu">len</span>(x),<span class="fu">len</span>(x)) <span class="co"># assign default value</span></span>
<span id="cb2-7"><a href="#cb2-7" tabindex="-1"></a>      cump <span class="ot">=</span> <span class="fu">cumsum</span>(prob)</span>
<span id="cb2-8"><a href="#cb2-8" tabindex="-1"></a>    }</span>
<span id="cb2-9"><a href="#cb2-9" tabindex="-1"></a>  U <span class="ot">=</span> <span class="fu">runif</span>(size)</span>
<span id="cb2-10"><a href="#cb2-10" tabindex="-1"></a>  <span class="fu">return</span>(x[<span class="fu">findInterval</span>(U,cump)<span class="sc">+</span><span class="dv">1</span>]) <span class="co"># discrete inverse transformation</span></span>
<span id="cb2-11"><a href="#cb2-11" tabindex="-1"></a>}</span></code></pre></div>
</div>
<div id="example" class="section level2">
<h2>Example</h2>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a>x <span class="ot">=</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">3</span>,<span class="dv">4</span>)</span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>prob <span class="ot">=</span> <span class="fu">c</span>(<span class="fl">0.2</span>,<span class="fl">0.2</span>,<span class="fl">0.3</span>,<span class="fl">0.3</span>)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a>samples <span class="ot">=</span> <span class="fu">sample.me</span>(<span class="at">x =</span> x, <span class="at">size =</span> <span class="dv">10000</span>, <span class="at">prob =</span> prob)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a><span class="fu">table</span>(samples)</span></code></pre></div>
<pre><code>## samples
##    1    2    3    4 
## 1987 1898 3050 3065</code></pre>
</div>
</div>
<div id="exercise-3.2" class="section level1">
<h1>Exercise 3.2</h1>
<div id="restate-1" class="section level2">
<h2>Restate</h2>
<p>Standard Laplace distribution的密度函数为<span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}\)</span>，用逆变换法从该分布中生成1000个随机样本，并用本章中某种方法将他与目标分布进行比较。</p>
</div>
<div id="compute" class="section level2">
<h2>Compute</h2>
<p><span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}\)</span>，于是<span class="math inline">\(F(x)=\frac{1}{2}e^x(x\le
0),1-\frac{1}{2}e^{-x}(x&gt; 0)\)</span>，于是有<span class="math inline">\(F^{-1}(u)=ln(2u)(0&lt;u\le
\frac{1}{2}),-ln(2-2u)(\frac{1}{2}&lt; u&lt;1)\)</span></p>
</div>
<div id="code" class="section level2">
<h2>Code</h2>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># The function to generate samples from standard Laplace distribution</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>rlaplace <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>  U <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>  samples <span class="ot">=</span> <span class="fu">ifelse</span>(U <span class="sc">&lt;</span> <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span>, <span class="fu">log</span>(<span class="dv">2</span><span class="sc">*</span>U),<span class="sc">-</span><span class="fu">log</span>(<span class="dv">2-2</span><span class="sc">*</span>U)) <span class="co"># continuous inverse transformation</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># generate samples and qqplot</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>samples <span class="ot">=</span> <span class="fu">rlaplace</span>(<span class="dv">1000</span>)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>sampleq <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>n),<span class="at">to =</span> <span class="dv">1</span><span class="sc">-</span> <span class="dv">1</span><span class="sc">/</span>(<span class="dv">2</span><span class="sc">*</span>n),<span class="at">by =</span> <span class="dv">1</span><span class="sc">/</span>n)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>samplet <span class="ot">=</span> <span class="fu">sort</span>(<span class="fu">ifelse</span>(samples <span class="sc">&lt;</span> <span class="dv">0</span>, <span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(samples), <span class="dv">1-1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span>samples)))</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(<span class="st">`</span><span class="at">q.therotical</span><span class="st">`</span> <span class="ot">=</span> samplet, <span class="st">`</span><span class="at">q.sample</span><span class="st">`</span> <span class="ot">=</span> sampleq)</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a><span class="fu">ggplot</span>(dat, <span class="fu">aes</span>(<span class="at">x =</span> <span class="st">`</span><span class="at">q.therotical</span><span class="st">`</span>, <span class="at">y =</span> <span class="st">`</span><span class="at">q.sample</span><span class="st">`</span>)) <span class="sc">+</span></span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  <span class="fu">geom_point</span>() <span class="sc">+</span></span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  <span class="fu">geom_abline</span>(<span class="at">slope =</span> <span class="dv">1</span>,<span class="at">intercept =</span> <span class="dv">0</span>) <span class="sc">+</span></span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  <span class="fu">ggtitle</span>(<span class="st">&#39;qqplot of generated samples&#39;</span>) <span class="sc">+</span></span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>  <span class="fu">theme</span>(<span class="at">plot.title =</span> <span class="fu">element_text</span>(<span class="at">hjust=</span><span class="fl">0.5</span>,<span class="at">size=</span><span class="fu">rel</span>(<span class="fl">1.5</span>)))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>因此，认为生成的数据服从Standard Laplace distribution。</p>
</div>
</div>
<div id="exercise-3.7" class="section level1">
<h1>Exercise 3.7</h1>
<div id="restate-2" class="section level2">
<h2>Restate</h2>
<p>写一个函数，用接受拒绝法实现从Beta(a,b)分布中抽取n个随机样本。从Beta(3,2)中生成1000个随机样本，画出样本的频率分布直方图并叠加理论密度曲线。</p>
</div>
<div id="prepare" class="section level2">
<h2>Prepare</h2>
<p><span class="math inline">\(Beta(a,b):f(x)=\frac{1}{Beta(a,b)}x^{a-1}(1-x)^{b-1}\)</span></p>
</div>
<div id="code-1" class="section level2">
<h2>Code</h2>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="co"># return the pdf of Beta(a,b) distribution at x</span></span>
<span id="cb7-2"><a href="#cb7-2" tabindex="-1"></a>pdfBeta <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,x){</span>
<span id="cb7-3"><a href="#cb7-3" tabindex="-1"></a>  density <span class="ot">=</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">beta</span>(a,b)<span class="sc">*</span>x<span class="sc">^</span>(a<span class="dv">-1</span>)<span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>x)<span class="sc">^</span>(b<span class="dv">-1</span>)</span>
<span id="cb7-4"><a href="#cb7-4" tabindex="-1"></a>  <span class="fu">return</span>(density)</span>
<span id="cb7-5"><a href="#cb7-5" tabindex="-1"></a>}</span>
<span id="cb7-6"><a href="#cb7-6" tabindex="-1"></a></span>
<span id="cb7-7"><a href="#cb7-7" tabindex="-1"></a><span class="co"># Use acceptance-rejection method to generate samples from Beta(a,b)</span></span>
<span id="cb7-8"><a href="#cb7-8" tabindex="-1"></a>myBeta <span class="ot">&lt;-</span> <span class="cf">function</span>(a,b,n){</span>
<span id="cb7-9"><a href="#cb7-9" tabindex="-1"></a>  <span class="cf">if</span>((a <span class="sc">&lt;=</span> <span class="dv">1</span>)<span class="sc">|</span>(b <span class="sc">&lt;=</span> <span class="dv">1</span>)){</span>
<span id="cb7-10"><a href="#cb7-10" tabindex="-1"></a>    <span class="fu">stop</span>(<span class="st">&#39;Input a,b must &gt; 1.&#39;</span>)</span>
<span id="cb7-11"><a href="#cb7-11" tabindex="-1"></a>  }<span class="cf">else</span>{</span>
<span id="cb7-12"><a href="#cb7-12" tabindex="-1"></a>    samples <span class="ot">=</span> <span class="cn">NULL</span></span>
<span id="cb7-13"><a href="#cb7-13" tabindex="-1"></a>    len <span class="ot">=</span> <span class="dv">0</span></span>
<span id="cb7-14"><a href="#cb7-14" tabindex="-1"></a>    maxnum <span class="ot">=</span> <span class="fu">pdfBeta</span>(a,b,(a<span class="dv">-1</span>)<span class="sc">/</span>(a<span class="sc">+</span>b<span class="dv">-2</span>))</span>
<span id="cb7-15"><a href="#cb7-15" tabindex="-1"></a>    <span class="co"># loop until there are enough samples</span></span>
<span id="cb7-16"><a href="#cb7-16" tabindex="-1"></a>    <span class="cf">while</span>(len <span class="sc">&lt;</span> n){</span>
<span id="cb7-17"><a href="#cb7-17" tabindex="-1"></a>      U <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb7-18"><a href="#cb7-18" tabindex="-1"></a>      X <span class="ot">=</span> <span class="fu">runif</span>(n)</span>
<span id="cb7-19"><a href="#cb7-19" tabindex="-1"></a>      sample.temp <span class="ot">=</span> X[U<span class="sc">&lt;=</span><span class="fu">pdfBeta</span>(a,b,X)<span class="sc">/</span>maxnum]</span>
<span id="cb7-20"><a href="#cb7-20" tabindex="-1"></a>      samples <span class="ot">=</span> <span class="fu">c</span>(samples, sample.temp)</span>
<span id="cb7-21"><a href="#cb7-21" tabindex="-1"></a>      len <span class="ot">=</span> len <span class="sc">+</span> <span class="fu">length</span>(sample.temp)</span>
<span id="cb7-22"><a href="#cb7-22" tabindex="-1"></a>    }</span>
<span id="cb7-23"><a href="#cb7-23" tabindex="-1"></a>    <span class="fu">return</span>(samples[<span class="dv">1</span><span class="sc">:</span>n])</span>
<span id="cb7-24"><a href="#cb7-24" tabindex="-1"></a>  }</span>
<span id="cb7-25"><a href="#cb7-25" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co">#sample and draw</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a>samples <span class="ot">=</span> <span class="fu">myBeta</span>(<span class="dv">3</span>,<span class="dv">2</span>,<span class="dv">1000</span>)</span>
<span id="cb8-3"><a href="#cb8-3" tabindex="-1"></a>xticks <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="dv">0</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb8-4"><a href="#cb8-4" tabindex="-1"></a>yticks <span class="ot">=</span> <span class="fu">pdfBeta</span>(<span class="dv">3</span>,<span class="dv">2</span>,xticks)</span>
<span id="cb8-5"><a href="#cb8-5" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(samples, xticks, yticks)</span>
<span id="cb8-6"><a href="#cb8-6" tabindex="-1"></a><span class="fu">ggplot</span>(dat)<span class="sc">+</span></span>
<span id="cb8-7"><a href="#cb8-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>samples,<span class="at">y=</span><span class="fu">after_stat</span>(density)),<span class="at">binwidth =</span> <span class="fl">0.02</span>,<span class="at">fill=</span><span class="st">&#39;grey&#39;</span>)<span class="sc">+</span></span>
<span id="cb8-8"><a href="#cb8-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>xticks,<span class="at">y=</span>yticks),<span class="at">color=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="exercise-3.9" class="section level1">
<h1>Exercise 3.9</h1>
<div id="restate-3" class="section level2">
<h2>Restate</h2>
<p>Rescaled Epanechnikov kernel:<span class="math inline">\(f_e(x)=\frac{3}{4}(1-x^2),|x|\le 1\)</span>。</p>
<p>有一种算法模拟该分布：</p>
<p>生成iid <span class="math inline">\(U_1,U_2,U_3 \sim
Uniform(-1,1)\)</span>。如果<span class="math inline">\(|U_3|\ge|U_2|,|U_3|\ge|U_1|\)</span>则输出<span class="math inline">\(U_2\)</span>，否则输出<span class="math inline">\(U_3\)</span>。</p>
<p>写一个函数实现从<span class="math inline">\(f_e\)</span>中抽取随机样本，并构造样本直方图密度估计。</p>
</div>
<div id="code-2" class="section level2">
<h2>Code</h2>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb9-1"><a href="#cb9-1" tabindex="-1"></a><span class="co"># write a function to sample from Rescaled Epanechnikov kernel</span></span>
<span id="cb9-2"><a href="#cb9-2" tabindex="-1"></a>repane <span class="ot">&lt;-</span> <span class="cf">function</span>(n){</span>
<span id="cb9-3"><a href="#cb9-3" tabindex="-1"></a>  u1 <span class="ot">=</span> <span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb9-4"><a href="#cb9-4" tabindex="-1"></a>  u2 <span class="ot">=</span> <span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb9-5"><a href="#cb9-5" tabindex="-1"></a>  u3 <span class="ot">=</span> <span class="fu">runif</span>(n,<span class="sc">-</span><span class="dv">1</span>,<span class="dv">1</span>)</span>
<span id="cb9-6"><a href="#cb9-6" tabindex="-1"></a>  logic1 <span class="ot">=</span> (<span class="fu">abs</span>(u3)<span class="sc">&gt;=</span><span class="fu">abs</span>(u2))<span class="sc">&amp;</span>(<span class="fu">abs</span>(u3)<span class="sc">&gt;=</span><span class="fu">abs</span>(u1))</span>
<span id="cb9-7"><a href="#cb9-7" tabindex="-1"></a>  logic2 <span class="ot">=</span> <span class="sc">!</span>logic1</span>
<span id="cb9-8"><a href="#cb9-8" tabindex="-1"></a>  samples <span class="ot">=</span> logic1<span class="sc">*</span>u2 <span class="sc">+</span> logic2<span class="sc">*</span>u3</span>
<span id="cb9-9"><a href="#cb9-9" tabindex="-1"></a>  <span class="fu">return</span>(samples)</span>
<span id="cb9-10"><a href="#cb9-10" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co"># generate samples</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>samples <span class="ot">=</span> <span class="fu">repane</span>(<span class="dv">10000</span>)</span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>xticks <span class="ot">=</span> <span class="fu">seq</span>(<span class="at">from =</span> <span class="sc">-</span><span class="dv">1</span>, <span class="at">to =</span> <span class="dv">1</span>, <span class="at">length.out =</span> <span class="dv">1000</span>)</span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>yticks <span class="ot">=</span> <span class="dv">3</span><span class="sc">/</span><span class="dv">4</span><span class="sc">*</span>(<span class="dv">1</span><span class="sc">-</span>xticks<span class="sc">^</span><span class="dv">2</span>)</span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>dat <span class="ot">=</span> <span class="fu">data.frame</span>(samples, xticks, yticks)</span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a><span class="fu">ggplot</span>(dat)<span class="sc">+</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>  <span class="fu">geom_histogram</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>samples,<span class="at">y=</span><span class="fu">after_stat</span>(density)),<span class="at">binwidth =</span> <span class="fl">0.02</span>,<span class="at">fill=</span><span class="st">&#39;grey&#39;</span>)<span class="sc">+</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>  <span class="fu">geom_line</span>(<span class="at">mapping =</span> <span class="fu">aes</span>(<span class="at">x=</span>xticks,<span class="at">y=</span>yticks),<span class="at">color=</span><span class="st">&#39;red&#39;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>这里取得直方图密度估计为：<span class="math inline">\(f_n(x)=\frac{1}{nh}R(t_i,t_{i+1})\)</span>，其中<span class="math inline">\(n=10000,h=0.02\)</span></p>
</div>
</div>
<div id="exercise-3.10" class="section level1">
<h1>Exercise 3.10</h1>
<div id="restate-4" class="section level2">
<h2>Restate</h2>
<p>证明Ex3.9里给出的算法生成的变量服从<span class="math inline">\(f_e\)</span>。</p>
<p><span class="math inline">\(f_e(x) =
\frac{3}{4}(1-x^2),F_e(x)=\frac{3}{4}x-\frac{1}{4}x^3|_{-1}^x=-\frac{1}{4}x^3+\frac{3}{4}x+\frac{1}{2}\)</span></p>
<p><span class="math inline">\(P(X\le x)=P(U_2\le
x,|U_3|=max(|U_1|,|U_2|,|U_3|))+P(U_3\le x,|U_3|\neq
max(|U_1|,|U_2|,|U_3|)) \\ =
\frac{1}{2}\int_{-1}^xdu_2\int_{|u_2|}^1d|u_3|\int_0^{|u_3|}d|u_1|+\frac{1}{2}\int_{-1}^xdu_3\int_0^1
d|u_1|\int_{|u_3|}^1
d|u_2|+\frac{1}{2}\int_{-1}^xdu_3\int_{|u_3|}^1d|u_1|\int_{0}^{|u_3|}d|u_2|\\
=\frac{1}{2}(\frac{1}{2}x-\frac{1}{6}x^3+\frac{1}{3})+\frac{1}{2}\int_{-1}^x(1-|u_3|)du_3+\frac{1}{2}\int_{-1}^x(|u_3|-u_3^2)du_3\\
=-\frac{1}{12}x^3+\frac{1}{4}x+\frac{1}{6}+\frac{1}{2}\int_{-1}^x(1-u_3^2)du_3=-\frac{1}{12}x^3+\frac{1}{4}x+\frac{1}{6}+\frac{1}{2}(x+1)-\frac{1}{6}(x^3+1)=-\frac{1}{4}x^3+\frac{3}{4}x+\frac{1}{2}\)</span></p>
<p>由是可得Ex3.9中的算法生成服从<span class="math inline">\(f_e\)</span>的分布。</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
