<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Huiyang Peng" />


<title>Homework-2023.11.6</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework-2023.11.6</h1>
<h4 class="author">Huiyang Peng</h4>
<h4 class="date">2023-11-6</h4>



<div id="supplementary-question" class="section level1">
<h1>Supplementary question</h1>
<div id="restate" class="section level2">
<h2>Restate</h2>
<p>考虑模型<span class="math inline">\(P(Y=1|X_1,X_2,X_3)=\frac{exp(a+b_1X_1+b_2X_2+b_3X_3)}{1+exp(a+b_1X_1+b_2X_2+b_3X_3)}\)</span>，其中<span class="math inline">\(X_1\sim P(1), X_2\sim Exp(1), X_3\sim
B(1,0.5)\)</span>。</p>
<p>(1)设计一个函数，输入<span class="math inline">\(N, b_1, b_2, b_3,
f_0\)</span>，生成输出<span class="math inline">\(a\)</span>。</p>
<p>(2)调用函数，令<span class="math inline">\(N=10^6, b_1=0,
b_2=1,b_3=-1,f_0=0.1,0.01,0.001,0.0001\)</span>。</p>
<p>(3)画图：<span class="math inline">\(-logf_0\)</span> vs <span class="math inline">\(a\)</span>。</p>
</div>
<div id="code" class="section level2">
<h2>Code</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a><span class="co"># the solve function</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>eva.a <span class="ot">&lt;-</span> <span class="cf">function</span>(N, b1, b2, b3, f0){</span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> <span class="fu">rpois</span>(N, <span class="dv">1</span>)</span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> <span class="fu">rexp</span>(N, <span class="dv">1</span>)</span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>  x3 <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">0</span>),<span class="at">size =</span> N, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>  f <span class="ot">&lt;-</span> <span class="cf">function</span>(a, x1, x2, x3, f0){</span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>    temp <span class="ot">=</span> <span class="fu">exp</span>(a<span class="sc">+</span>b1<span class="sc">*</span>x1<span class="sc">+</span>b2<span class="sc">*</span>x2<span class="sc">+</span>b3<span class="sc">*</span>x3)</span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>    <span class="fu">return</span>(<span class="fu">mean</span>(<span class="dv">1</span><span class="sc">/</span>(<span class="dv">1</span><span class="sc">+</span>temp))<span class="sc">-</span>f0)</span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>  }</span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">uniroot</span>(f, <span class="at">interval =</span> <span class="fu">c</span>(<span class="sc">-</span><span class="dv">10</span>,<span class="dv">10</span>), x1, x2, x3, f0)<span class="sc">$</span>root)</span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a><span class="co"># call the function</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>N <span class="ot">=</span> <span class="fl">1e6</span>; b1 <span class="ot">=</span> <span class="dv">0</span>; b2<span class="ot">=</span><span class="dv">1</span>; b3<span class="ot">=</span><span class="sc">-</span><span class="dv">1</span>; f<span class="ot">=</span><span class="fu">c</span>(<span class="fl">0.1</span>,<span class="fl">0.01</span>,<span class="fl">0.001</span>,<span class="fl">0.0001</span>);</span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>a <span class="ot">=</span> <span class="fu">numeric</span>(<span class="dv">4</span>)</span>
<span id="cb2-4"><a href="#cb2-4" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb2-5"><a href="#cb2-5" tabindex="-1"></a>  a[i] <span class="ot">&lt;-</span> <span class="fu">eva.a</span>(N, b1, b2, b3, f[i])</span>
<span id="cb2-6"><a href="#cb2-6" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="do">### draw the picture</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>neglogf <span class="ot">&lt;-</span> <span class="sc">-</span><span class="fu">log</span>(f)</span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">plot</span>(neglogf, a, <span class="at">type=</span><span class="st">&quot;o&quot;</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
</div>
<div id="exercise-9.4" class="section level1">
<h1>Exercise 9.4</h1>
<div id="restate-1" class="section level2">
<h2>Restate</h2>
<p>实现一个生成标准Laplace分布的随机游走Metropolis抽样，对于增量，从正态分布中生成。比较当建议分布的方差取不同值时所生成的链，并计算各个链的接受率。</p>
</div>
<div id="prepare" class="section level2">
<h2>Prepare</h2>
<p>标准Laplace分布：<span class="math inline">\(f(x)=\frac{1}{2}e^{-|x|}\)</span>，建议分布取<span class="math inline">\(N(X_t, \sigma^2)\)</span>。</p>
</div>
<div id="code-1" class="section level2">
<h2>Code</h2>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a>dlaplace <span class="ot">&lt;-</span> <span class="cf">function</span>(x){</span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>  <span class="fu">return</span>(<span class="dv">1</span><span class="sc">/</span><span class="dv">2</span><span class="sc">*</span><span class="fu">exp</span>(<span class="sc">-</span><span class="fu">abs</span>(x)))</span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a>}</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a></span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a><span class="co"># Laplace chain</span></span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a>laplace.Metropolis <span class="ot">&lt;-</span> <span class="cf">function</span>(sigma, x0, N){</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">numeric</span>(N)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>  U <span class="ot">&lt;-</span> <span class="fu">runif</span>(N)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>    y <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, x[i<span class="dv">-1</span>], sigma)</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>    <span class="cf">if</span> (U[i] <span class="sc">&lt;=</span> <span class="fu">dlaplace</span>(y)<span class="sc">/</span><span class="fu">dlaplace</span>(x[i<span class="dv">-1</span>])){</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> y</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a>      x[i] <span class="ot">&lt;-</span> x[i<span class="dv">-1</span>]</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb4-19"><a href="#cb4-19" tabindex="-1"></a>    }</span>
<span id="cb4-20"><a href="#cb4-20" tabindex="-1"></a>  }</span>
<span id="cb4-21"><a href="#cb4-21" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb4-22"><a href="#cb4-22" tabindex="-1"></a>}</span></code></pre></div>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># Generate chain</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">2000</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="fu">c</span>(.<span class="dv">05</span>, .<span class="dv">5</span>, <span class="dv">2</span>, <span class="dv">16</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="dv">25</span></span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>mc1 <span class="ot">&lt;-</span> <span class="fu">laplace.Metropolis</span>(sigma[<span class="dv">1</span>], x0, N)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a>mc2 <span class="ot">&lt;-</span> <span class="fu">laplace.Metropolis</span>(sigma[<span class="dv">2</span>], x0, N)</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>mc3 <span class="ot">&lt;-</span> <span class="fu">laplace.Metropolis</span>(sigma[<span class="dv">3</span>], x0, N)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>mc4 <span class="ot">&lt;-</span> <span class="fu">laplace.Metropolis</span>(sigma[<span class="dv">4</span>], x0, N)</span></code></pre></div>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="co"># Plot chain</span></span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">2</span>))</span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>mc <span class="ot">&lt;-</span> <span class="fu">cbind</span>(mc1<span class="sc">$</span>x, mc2<span class="sc">$</span>x, mc3<span class="sc">$</span>x, mc4<span class="sc">$</span>x)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a>  <span class="fu">plot</span>(mc[,j], <span class="at">type =</span> <span class="st">&quot;l&quot;</span>,</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a>       <span class="at">xlab =</span> <span class="fu">bquote</span>(sigma <span class="sc">==</span> .(<span class="fu">round</span>(sigma[j],<span class="dv">3</span>))),</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>       <span class="at">ylab =</span> <span class="st">&quot;X&quot;</span>, <span class="at">ylim =</span> <span class="fu">range</span>(mc[,j]))</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>}</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb7-1"><a href="#cb7-1" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">1</span>))</span></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb8-1"><a href="#cb8-1" tabindex="-1"></a><span class="co"># print acceptance rate</span></span>
<span id="cb8-2"><a href="#cb8-2" tabindex="-1"></a><span class="fu">print</span>(<span class="dv">1</span><span class="sc">-</span><span class="fu">c</span>(mc1<span class="sc">$</span>k, mc2<span class="sc">$</span>k, mc3<span class="sc">$</span>k, mc4<span class="sc">$</span>k)<span class="sc">/</span>N)</span></code></pre></div>
<pre><code>## [1] 0.977 0.826 0.539 0.092</code></pre>
<p>从收敛情况来看，<span class="math inline">\(\sigma=0.05\)</span>时链没有收敛，其他情况下都收敛了，其中<span class="math inline">\(\sigma=2\)</span>与<span class="math inline">\(\sigma=16\)</span>时收敛状况较好。建议分布的方差越低接受率越高。</p>
</div>
</div>
<div id="exercise-9.7" class="section level1">
<h1>Exercise 9.7</h1>
<p>用Gibbs采样实现一个生成二元正态链<span class="math inline">\((X_t,Y_t)\)</span>，具有零均值，单位标准差，相关系数0.9。画出丢去合适量的预烧值之后的生成样本。用这些样本拟合简单线性模型<span class="math inline">\(Y=\beta_0+\beta_1
X\)</span>并检查残差的正态性和等方差性。</p>
<div class="sourceCode" id="cb10"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb10-1"><a href="#cb10-1" tabindex="-1"></a><span class="co">#initialize</span></span>
<span id="cb10-2"><a href="#cb10-2" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="dv">5000</span> </span>
<span id="cb10-3"><a href="#cb10-3" tabindex="-1"></a>burn <span class="ot">&lt;-</span> <span class="dv">1000</span> </span>
<span id="cb10-4"><a href="#cb10-4" tabindex="-1"></a>X <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, N, <span class="dv">2</span>) <span class="co">#the chain, a bivariate sample</span></span>
<span id="cb10-5"><a href="#cb10-5" tabindex="-1"></a>rho <span class="ot">&lt;-</span> <span class="fl">0.9</span> <span class="co">#correlation</span></span>
<span id="cb10-6"><a href="#cb10-6" tabindex="-1"></a>mu1 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-7"><a href="#cb10-7" tabindex="-1"></a>mu2 <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb10-8"><a href="#cb10-8" tabindex="-1"></a>sigma1 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb10-9"><a href="#cb10-9" tabindex="-1"></a>sigma2 <span class="ot">&lt;-</span> <span class="dv">1</span></span>
<span id="cb10-10"><a href="#cb10-10" tabindex="-1"></a>s1 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma1</span>
<span id="cb10-11"><a href="#cb10-11" tabindex="-1"></a>s2 <span class="ot">&lt;-</span> <span class="fu">sqrt</span>(<span class="dv">1</span><span class="sc">-</span>rho<span class="sc">^</span><span class="dv">2</span>)<span class="sc">*</span>sigma2</span>
<span id="cb10-12"><a href="#cb10-12" tabindex="-1"></a></span>
<span id="cb10-13"><a href="#cb10-13" tabindex="-1"></a>X[<span class="dv">1</span>, ] <span class="ot">&lt;-</span> <span class="fu">c</span>(mu1, mu2)</span>
<span id="cb10-14"><a href="#cb10-14" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb10-15"><a href="#cb10-15" tabindex="-1"></a>  x2 <span class="ot">&lt;-</span> X[i<span class="dv">-1</span>, <span class="dv">2</span>]</span>
<span id="cb10-16"><a href="#cb10-16" tabindex="-1"></a>  m1 <span class="ot">&lt;-</span> mu1 <span class="sc">+</span> rho <span class="sc">*</span> (x2 <span class="sc">-</span> mu2) <span class="sc">*</span> sigma1<span class="sc">/</span>sigma2</span>
<span id="cb10-17"><a href="#cb10-17" tabindex="-1"></a>  X[i, <span class="dv">1</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m1, s1)</span>
<span id="cb10-18"><a href="#cb10-18" tabindex="-1"></a>  x1 <span class="ot">&lt;-</span> X[i, <span class="dv">1</span>]</span>
<span id="cb10-19"><a href="#cb10-19" tabindex="-1"></a>  m2 <span class="ot">&lt;-</span> mu2 <span class="sc">+</span> rho <span class="sc">*</span> (x1 <span class="sc">-</span> mu1) <span class="sc">*</span> sigma2<span class="sc">/</span>sigma1</span>
<span id="cb10-20"><a href="#cb10-20" tabindex="-1"></a>  X[i, <span class="dv">2</span>] <span class="ot">&lt;-</span> <span class="fu">rnorm</span>(<span class="dv">1</span>, m2, s2)</span>
<span id="cb10-21"><a href="#cb10-21" tabindex="-1"></a>}</span>
<span id="cb10-22"><a href="#cb10-22" tabindex="-1"></a>b <span class="ot">&lt;-</span> burn <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb10-23"><a href="#cb10-23" tabindex="-1"></a>x <span class="ot">&lt;-</span> X[b<span class="sc">:</span>N, ]</span>
<span id="cb10-24"><a href="#cb10-24" tabindex="-1"></a><span class="fu">plot</span>(x, <span class="at">main=</span><span class="st">&quot;&quot;</span>, <span class="at">cex=</span>.<span class="dv">5</span>, <span class="at">xlab=</span><span class="fu">bquote</span>(X[<span class="dv">1</span>]),</span>
<span id="cb10-25"><a href="#cb10-25" tabindex="-1"></a><span class="at">ylab=</span><span class="fu">bquote</span>(X[<span class="dv">2</span>]), <span class="at">ylim=</span><span class="fu">range</span>(x[,<span class="dv">2</span>]))</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb11-1"><a href="#cb11-1" tabindex="-1"></a>lr <span class="ot">=</span> <span class="fu">lm</span>(x[,<span class="dv">2</span>]<span class="sc">~</span>x[,<span class="dv">1</span>])</span>
<span id="cb11-2"><a href="#cb11-2" tabindex="-1"></a><span class="fu">barplot</span>(lr<span class="sc">$</span>residuals, <span class="at">space =</span> <span class="dv">0</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<p>可以看出残差分布是正态、等方差的。</p>
</div>
<div id="exercise-9.10" class="section level1">
<h1>Exercise 9.10</h1>
<p>用Gelman-Rubin法监控Example
9.1中链的收敛情况，模拟链直到链已经大致收敛到目标分布根据<span class="math inline">\(\hat{R}&lt;1.2\)</span>。另外，用<code>coda</code>包通过Gelman-Rubin法检查链的收敛性。Hints:
<code>coda</code>中的函数gelman.diag,gelman.plot, as.mcmc,
mcmc.list。</p>
<div id="code-2" class="section level2">
<h2>Code</h2>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb12-1"><a href="#cb12-1" tabindex="-1"></a><span class="co"># check with manual code</span></span>
<span id="cb12-2"><a href="#cb12-2" tabindex="-1"></a>Gelman.Rubin <span class="ot">&lt;-</span> <span class="cf">function</span>(psi) {</span>
<span id="cb12-3"><a href="#cb12-3" tabindex="-1"></a>  psi <span class="ot">&lt;-</span> <span class="fu">as.matrix</span>(psi)</span>
<span id="cb12-4"><a href="#cb12-4" tabindex="-1"></a>  n <span class="ot">&lt;-</span> <span class="fu">ncol</span>(psi)</span>
<span id="cb12-5"><a href="#cb12-5" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="fu">nrow</span>(psi)</span>
<span id="cb12-6"><a href="#cb12-6" tabindex="-1"></a>  psi.means <span class="ot">&lt;-</span> <span class="fu">rowMeans</span>(psi)</span>
<span id="cb12-7"><a href="#cb12-7" tabindex="-1"></a>  B <span class="ot">&lt;-</span> n <span class="sc">*</span> <span class="fu">var</span>(psi.means) </span>
<span id="cb12-8"><a href="#cb12-8" tabindex="-1"></a>  psi.w <span class="ot">&lt;-</span> <span class="fu">apply</span>(psi, <span class="dv">1</span>, <span class="st">&quot;var&quot;</span>) </span>
<span id="cb12-9"><a href="#cb12-9" tabindex="-1"></a>  W <span class="ot">&lt;-</span> <span class="fu">mean</span>(psi.w) </span>
<span id="cb12-10"><a href="#cb12-10" tabindex="-1"></a>  v.hat <span class="ot">&lt;-</span> W<span class="sc">*</span>(n<span class="dv">-1</span>)<span class="sc">/</span>n <span class="sc">+</span> (B<span class="sc">/</span>n) </span>
<span id="cb12-11"><a href="#cb12-11" tabindex="-1"></a>  r.hat <span class="ot">&lt;-</span> v.hat <span class="sc">/</span> W </span>
<span id="cb12-12"><a href="#cb12-12" tabindex="-1"></a>  <span class="fu">return</span>(r.hat)</span>
<span id="cb12-13"><a href="#cb12-13" tabindex="-1"></a>}</span>
<span id="cb12-14"><a href="#cb12-14" tabindex="-1"></a></span>
<span id="cb12-15"><a href="#cb12-15" tabindex="-1"></a>f <span class="ot">&lt;-</span> <span class="cf">function</span>(x, sigma) {</span>
<span id="cb12-16"><a href="#cb12-16" tabindex="-1"></a>  <span class="cf">if</span> (<span class="fu">any</span>(x <span class="sc">&lt;</span> <span class="dv">0</span>)) <span class="fu">return</span> (<span class="dv">0</span>)</span>
<span id="cb12-17"><a href="#cb12-17" tabindex="-1"></a>  <span class="fu">stopifnot</span>(sigma <span class="sc">&gt;</span> <span class="dv">0</span>)</span>
<span id="cb12-18"><a href="#cb12-18" tabindex="-1"></a>  <span class="fu">return</span>((x <span class="sc">/</span> sigma<span class="sc">^</span><span class="dv">2</span>) <span class="sc">*</span> <span class="fu">exp</span>(<span class="sc">-</span>x<span class="sc">^</span><span class="dv">2</span> <span class="sc">/</span> (<span class="dv">2</span><span class="sc">*</span>sigma<span class="sc">^</span><span class="dv">2</span>)))</span>
<span id="cb12-19"><a href="#cb12-19" tabindex="-1"></a>}</span>
<span id="cb12-20"><a href="#cb12-20" tabindex="-1"></a></span>
<span id="cb12-21"><a href="#cb12-21" tabindex="-1"></a>gen.chain <span class="ot">&lt;-</span> <span class="cf">function</span>(x0, N, sigma){</span>
<span id="cb12-22"><a href="#cb12-22" tabindex="-1"></a>  <span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb12-23"><a href="#cb12-23" tabindex="-1"></a>  x <span class="ot">=</span> <span class="fu">numeric</span>(N)</span>
<span id="cb12-24"><a href="#cb12-24" tabindex="-1"></a>  x[<span class="dv">1</span>] <span class="ot">&lt;-</span> x0</span>
<span id="cb12-25"><a href="#cb12-25" tabindex="-1"></a>  k <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb12-26"><a href="#cb12-26" tabindex="-1"></a>  u <span class="ot">=</span> <span class="fu">runif</span>(N)</span>
<span id="cb12-27"><a href="#cb12-27" tabindex="-1"></a>  <span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">2</span><span class="sc">:</span>N) {</span>
<span id="cb12-28"><a href="#cb12-28" tabindex="-1"></a>    xt <span class="ot">=</span> x[i<span class="dv">-1</span>]</span>
<span id="cb12-29"><a href="#cb12-29" tabindex="-1"></a>    y <span class="ot">=</span> <span class="fu">rchisq</span>(<span class="dv">1</span>, <span class="at">df=</span>xt)</span>
<span id="cb12-30"><a href="#cb12-30" tabindex="-1"></a>    <span class="cf">if</span>(u[i] <span class="sc">&lt;=</span> (<span class="fu">f</span>(y,sigma)<span class="sc">*</span><span class="fu">dchisq</span>(xt, <span class="at">df=</span>y))<span class="sc">/</span>(<span class="fu">f</span>(xt,sigma)<span class="sc">*</span><span class="fu">dchisq</span>(y,<span class="at">df=</span>xt))){</span>
<span id="cb12-31"><a href="#cb12-31" tabindex="-1"></a>      x[i] <span class="ot">=</span> y</span>
<span id="cb12-32"><a href="#cb12-32" tabindex="-1"></a>      k <span class="ot">&lt;-</span> k <span class="sc">+</span> <span class="dv">1</span></span>
<span id="cb12-33"><a href="#cb12-33" tabindex="-1"></a>    }<span class="cf">else</span>{</span>
<span id="cb12-34"><a href="#cb12-34" tabindex="-1"></a>      x[i] <span class="ot">=</span> xt</span>
<span id="cb12-35"><a href="#cb12-35" tabindex="-1"></a>    }</span>
<span id="cb12-36"><a href="#cb12-36" tabindex="-1"></a>  }</span>
<span id="cb12-37"><a href="#cb12-37" tabindex="-1"></a>  <span class="fu">return</span>(<span class="fu">list</span>(<span class="at">x=</span>x, <span class="at">k=</span>k))</span>
<span id="cb12-38"><a href="#cb12-38" tabindex="-1"></a>}</span>
<span id="cb12-39"><a href="#cb12-39" tabindex="-1"></a></span>
<span id="cb12-40"><a href="#cb12-40" tabindex="-1"></a></span>
<span id="cb12-41"><a href="#cb12-41" tabindex="-1"></a>N <span class="ot">&lt;-</span> <span class="fl">1e4</span></span>
<span id="cb12-42"><a href="#cb12-42" tabindex="-1"></a>sigma <span class="ot">&lt;-</span> <span class="dv">4</span></span>
<span id="cb12-43"><a href="#cb12-43" tabindex="-1"></a>b <span class="ot">&lt;-</span> <span class="fl">1e3</span></span>
<span id="cb12-44"><a href="#cb12-44" tabindex="-1"></a>x0 <span class="ot">&lt;-</span> <span class="fu">c</span>(<span class="dv">1</span>,<span class="dv">2</span>,<span class="dv">4</span>,<span class="dv">8</span>)</span>
<span id="cb12-45"><a href="#cb12-45" tabindex="-1"></a>chains <span class="ot">&lt;-</span> <span class="fu">matrix</span>(<span class="dv">0</span>, <span class="at">nrow =</span> <span class="dv">4</span>, <span class="at">ncol =</span> N)</span>
<span id="cb12-46"><a href="#cb12-46" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="dv">4</span>) {</span>
<span id="cb12-47"><a href="#cb12-47" tabindex="-1"></a>  chains[i,] <span class="ot">&lt;-</span> <span class="fu">gen.chain</span>(x0[i], N, sigma)<span class="sc">$</span>x</span>
<span id="cb12-48"><a href="#cb12-48" tabindex="-1"></a>}</span>
<span id="cb12-49"><a href="#cb12-49" tabindex="-1"></a>psi <span class="ot">=</span> <span class="fu">t</span>(<span class="fu">apply</span>(chains, <span class="dv">1</span>, cumsum))</span>
<span id="cb12-50"><a href="#cb12-50" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span><span class="fu">nrow</span>(psi)){</span>
<span id="cb12-51"><a href="#cb12-51" tabindex="-1"></a>  psi[i,] <span class="ot">&lt;-</span> psi[i,] <span class="sc">/</span> (<span class="dv">1</span><span class="sc">:</span><span class="fu">ncol</span>(psi))</span>
<span id="cb12-52"><a href="#cb12-52" tabindex="-1"></a>}</span>
<span id="cb12-53"><a href="#cb12-53" tabindex="-1"></a>rhat <span class="ot">&lt;-</span> <span class="fu">rep</span>(<span class="dv">0</span>, N)</span>
<span id="cb12-54"><a href="#cb12-54" tabindex="-1"></a><span class="cf">for</span> (j <span class="cf">in</span> (b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N)</span>
<span id="cb12-55"><a href="#cb12-55" tabindex="-1"></a>rhat[j] <span class="ot">&lt;-</span> <span class="fu">Gelman.Rubin</span>(psi[,<span class="dv">1</span><span class="sc">:</span>j])</span>
<span id="cb12-56"><a href="#cb12-56" tabindex="-1"></a><span class="fu">plot</span>(rhat[(b<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>N], <span class="at">type=</span><span class="st">&quot;l&quot;</span>, <span class="at">xlab=</span><span class="st">&quot;&quot;</span>, <span class="at">ylab=</span><span class="st">&quot;R&quot;</span>)</span>
<span id="cb12-57"><a href="#cb12-57" tabindex="-1"></a><span class="fu">abline</span>(<span class="at">h=</span><span class="fl">1.2</span>, <span class="at">lty=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb13-1"><a href="#cb13-1" tabindex="-1"></a><span class="co"># check with coda</span></span>
<span id="cb13-2"><a href="#cb13-2" tabindex="-1"></a><span class="fu">library</span>(coda)</span>
<span id="cb13-3"><a href="#cb13-3" tabindex="-1"></a>mc1 <span class="ot">&lt;-</span> <span class="fu">mcmc</span>(<span class="at">data=</span>chains[<span class="dv">1</span>,])</span>
<span id="cb13-4"><a href="#cb13-4" tabindex="-1"></a>mc2 <span class="ot">&lt;-</span> <span class="fu">mcmc</span>(<span class="at">data=</span>chains[<span class="dv">2</span>,])</span>
<span id="cb13-5"><a href="#cb13-5" tabindex="-1"></a>mc3 <span class="ot">&lt;-</span> <span class="fu">mcmc</span>(<span class="at">data=</span>chains[<span class="dv">3</span>,])</span>
<span id="cb13-6"><a href="#cb13-6" tabindex="-1"></a>mc4 <span class="ot">&lt;-</span> <span class="fu">mcmc</span>(<span class="at">data=</span>chains[<span class="dv">4</span>,])</span>
<span id="cb13-7"><a href="#cb13-7" tabindex="-1"></a>mcs <span class="ot">&lt;-</span> <span class="fu">mcmc.list</span>(<span class="fu">list</span>(mc1,mc2,mc3,mc4))</span>
<span id="cb13-8"><a href="#cb13-8" tabindex="-1"></a><span class="fu">gelman.plot</span>(mcs)</span></code></pre></div>
<p><img src="data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAeAAAAHgCAMAAABKCk6nAAAAbFBMVEUAAAAAADoAAGYAOjoAOpAAZrY6AAA6ADo6AGY6Ojo6kNtmAABmADpmkJBmtrZmtv+QOgCQOjqQOmaQZgCQkGaQkNuQ2/+2ZgC225C2/7a2///bkDrb/7bb///fU2v/tmb/25D//7b//9v///+yL39UAAAACXBIWXMAAA7DAAAOwwHHb6hkAAARmklEQVR4nO2di3bbuBFA6TT2bq20TtutuRs1kmX9/z+WAEiK4htDjA1O7j0nNsUHyOgaT4LD4gqmKT77AkAXBBsHwcZBsHEQbBwEGwfBxkGwcRBsHAQbB8HGQbBxEGwcBBsHwcZBsHEQbBwEGwfBxkGwcRBsHAQbB8HGQbBxEGwcBBsHwcZBsHEQbBwEGwfBxkGwcRBsHAQbB8HGQbBxEGwcBBsHwcZBsHEQbBwEGwfBxkGwcRBsHAQbB8HGQbBxEGwcBBsHwcZBsHEQbBwEGwfBxkGwcRBsHAQbB8HGQbBxEGwcBBsHwcZBsHEQbBwEGwfBxkGwcRBsHAQbB8HGQbBxEGwcBBsHwcZBsHEQbJzEggv4ID5LcNrkYAoEGwfBxkGwcRBsHAQbB8HGQbBxEGwcBBsnQ8GntGf6xUGwcRBsHAQbJ0PBkJIMBZODU4Jg4yDYOAg2DoKNg2DjKAl+/x6m9H35EZ8cglOiI/hYPIeFc7OwKTmQoyL4/Xur9fj1Z2xy5OCUqAi+HF6axfNEIY3gDyK/HHxC8BLnh9dOHppHqw6uTy+ogxG8SCV49b5KrejLIbSiJ/IvgjeRgeBNyWG44u3pn1UmeX57KnxpeKxyiy8Mq4WHP5oiuiz81svB7TteZiM4U96eqmx6dAMJR/ev+vD2VBkuqw/nohZcPl79lsvB7TuerXMUbJaY5zy9zvrHy+Xgcm/VI6mWq4UyCL58e/Vbr35z2DQ85+qL2/I/i0mO/OvxvpofodJ1C77X2WlFn13R7D9MtKuV+sG3v8vofjCCPfeC6y/z5XgnuKqPv/z59AmCq47w5CD0YnInFDtGcvC1GTeqBbe7fLzgyvCjNDkEe+4Et/JCRXsMgr3t82cU0ddw3rFUlkNHINhzJzg0kcu6rdy0okPmrXpPnyF4S3IIvvYF+36wL567/WC3/Fo3qRH8i5KjYEiItuAj3aTPJb8cjOCk5CgYxQlBsHEQbJz8BFML1/herr+dEMah/cowzP/oesd+NsX794WpO/ndbEBwoPS3gGt9l0M99Pv2WxiVfv/+7IeDzwtDwhnebABPuAXczFlse5vNLFUnutr4/q+lyTs53myAazPvqr6N5G/8e46dnFwJXszAH32zYUVyCPbUgsPXWLYFYvn3MDnLF9HPyxk4w0aW4Vb0yTHzu0t9Y9ALDsX11S+5Mrt8rhtZyxkYwdkSGllecH+abFMRVxm4as/ON3cQnC1l1QX5y82ru5a96eVN47rKwOXjYOs9+QmmFu7w9vuPbgndrA19JZ+Bnycf/wogOGt8N6kzITYs1kqrDLxPwXCthzbu+koeN9fdN7J8Br7usIgm+9a44cBgth7lCGMLZTtq6bvE+2tkITgtOQrGcUIQbBwEGyc7wQ4MpwPBxslSMKQjO8Hk3rQg2DhZCkZyOhBsHAQbJzvBDgSnA8HGyVIwpCM7weTetCgJLovi0Yf1n5odjeAPQkewm0pUukekBvPFFpOjFZ0WFcE+IHiYSRQdEBzBaVF6uvClDcoW+3QhgtOSXQ52IDgdynVw5+0NEckhOB3ZtaIhLfSDjYNg46g94S98d+Gp/QFJUGpkid9diODE6HWTArHdJAQnRm+gIyB4dyGCU5JbDvYgOB1adfDEuwtXhPSHpCi1osXvLiTzJia3fjCCE5OlYCynQ1twbEh/BCeGHGyc3AR7EJwOBBsnS8GQjtwEk3kTozQWLQ7pj+DE6ORgeUj/U+cnJEDthr8wpD+CE6NVB0tD+iM4Mbk1sgIITgaCjZOnYEhGboLJu4lBsHHyFIzmZCDYOAg2TrzgySdCE54XwcmIF9yZ1a52XgQnQ1BEz7+IKfV5YRuSHDx/I3DTecm6qcmskYXg1OQpGM/JkAh+eyqat66lPi+CUyNpZPkHyo4LN3xl50VwauT94KkHQ1OcF8HJkPeDt/WWEPxB5JmDIRl51sGQjDxb0ZCMPPrBp94CnpMhaGR9C3k3ZSMLwWrIBU892u0pq42uJJ8syBH8QcQKLm9PHc3cFvZ+f3udubc4IXjiM4iR5+AZ/JsaSv/wyro4WQhWQy3SXd1dFkW6g3RIBJdVrpyMMhr2qHLvMSIHt5B1UyMQXHpnl8PM84OXw5cfnRc3rD8vglOjNRZ9Dg2xyT+C3nlPE79hKxvGolPebECwFoIiOoxCvz1tmj2L4A9CaSw6NqQ//SQtdMaio0P6I1gLFcFbA4JDOgSCm4nR040seUh/cm5qZP3g42NVEU/f8JfnYASnRtIPfr6eK21zU3aiQ/r37yIhOhWygY6333/4f5PEhvRHsBaygQ53R2lWcOx5EayFZKCjajeVz2lnVdJN0kJ0N+nRFcHrRipXhvRHsBZ5TLoDNSIFVy2sFTM6xOcl4yYnWvAzgndFbBF9XAz1LTtvL7oOplOhMulOcF4EK6E06S46pD+CldBpRceH9D/NfgQxSt2k6JD+CFZCqx8sDekPiRE0sv4bfr//O/0T/mTc5MhuF15dFlUI4YDg5Aif8K/ayQuVbOR5aUUrIamDz1tHOUbOi2AlRI2s+QeTROdFsBKyVvRSGzn+vHSTlIi+2aA6Fj31EcRwP9g4eQkm4yZHIHjxuSP5eRGcHMnEd5WQ/qf2x/V+CTYhHslKfV4E6yB/wj/xeRGsg2Ti+7ZByonz0k/SQTQWnSALI/iDkBTRiq/VgdTQDzYOgo2TjeDT9c4vqhMheLJBpw5GsA7kYOPII92lPu9p5hOIyWYkC8E6SAY6eH/wjlAd6JgJtTR6XrJtenJ5+MyD4PTotKLraZdROfhEK1oDpRkdl4OLwYPgz0dtRkf58IrgDNCb0XEsnmMFT34CMYr94LenvyH409Gc0VFV1nHdJEiPoA6eCyS87bxk2/QoPboS+86GAILTo9MPjn5nw5VWtBIqgkUR3xGsgkCw6ycdZ2J9C9/ZgGAVJAMdX3++PT3Wr48dRfbOhtPkB5Aj6we7qdFzdw2j39ngQLAGMsFutHL23YWx72wALSRF9KO7lTD7elnhecm26RE1soqH161PKCH4g9CeVbnynQ2OE61oBbKZNotgHTIUXIQPY6A9mqwEdzeNukRwNAg2TkaCV2xCcDQ5TZs9LZ3phOBodHJw/DsbHMuCY64BPEpFdPQ7G65t/iymm9EIjkerDha8s2FZMMSTUSNrjWC0x5KR4CuCFdiV4BOCo8lJcLNlchuC48lJ8F0OHt+O4Fh2JhhiyVbwiE0EC9iTYBCQk+Bmw5xgvEeSo2D/D8Fp2JPg0/hqmCNbwSMgWACCjbM3wRBJtoLpB6dhT4JBwN4E4z0SBBsnN8FF82NosvduNFhFtoKHnDo/YS1ZCh7fimAJuxMMcWQreKIOhkiUBB+LIkyMjngAvLN+VDBI0BF8fHi9hiAeyQUjPg4VwSFO1vv3rz/lgukIp0FFcBPprvz6M53g090vWIliDr66iEtywX1Ovd+wCqU6uNZ6OUS9VqddjeBkqLWiQyE9+aCwXDBEkVk/uCN4og6GOPYjGEQoCZaF9L+tpiOcCqVGliCk/91qBKdCt5sUFRC8u3oo+DRYgDWoDnRcY0L6360ebkawjHxzcA8Ey9CqgwUh/btnmREMUSi1ooUh/YvOwlQdDFHk1Q+eEQwydigY8zFoC467m4Tg5OSbgydfKIzgGDIVPNyOYBmZCx7r/SI4hswFc5t/K7kLZirWRpTGokUh/ecEgxCdHCwL6d9deVvkEYdNqN3wjw/pPyF4CIIj0KqDBSH9ZwWfJpZhgawaWQhOzx4ED+JEY3g9uxQM68lVcM8wgqXsRDBI2YXgoWGUr2UfgocrMbySPAQXw3VLfwEYXkcegsPHRcEFhqPJRLD/HCcYVpGL4GtRJBR8OvEu6ZpsBHvFCzusvQruId/ISPBiDu4X40sCEXzNS/DSDggWkK3gkVp6sBbDy+xN8IoszATbLrsWPPEWaeiwH8HFygMRfMfuBC8did97jAtGd76CpwY+aEdHkbHgiduHCI4ia8HdTDy2dMXwIkqCpZHuJvebmI+3GMkDwcl3dIgj3Y3sOOj+3h8aXpflbx5xD2kEFcHyOFmju/bHoPvHonUGFcHySHcT5+41qLntv54d5OCR3acjqbXbm8VfPXdr1cETke5kyY2nMJlEKNNryZ1bD6dbVf3raFdqRQsj3cUxofi+QzWtcsRz/Rew/dLyIe9+sCSVfnNsVtfdxta3JcP7Fjw6d6+3XZInm0ldBory3Ac6lmjr2/EgtuFzvKZQV9fLvfsX0ir8vgXwUS2B7Ac6FplvUC8W0uHp1PldRo1E6pnaXVv0TrpJcoqh335m73zBM6Gsh6w186kF/S4GOjYR5uoVw2K8J/P2sVmYDV3ecLPXFL397Wv/CnRysvkcvDAqUm8c7NL/QxjHb2/ENutG6tiZJPp/RMM/mKnf/f0m/oOL30/sjo4VIf3hg1AR/DEDHbCCnfeDYQkEG0dbcOwLoiEx5GDjINg4CDYOgo2DYOMojUXfBlJoRX8uOjlYGNIf0qN2w38ppD98EDqCF0P6b0jadBKfdxmKZWoeX20eSSDYeBIINp4Ego0ngWDjSSDYeBIINp4Ego0nYVIw5ACCjYNg4yDYOAg2DoKNg2DjINg4CDYOgo2DYOMg2DgINo6W4HNRPLzGHuTDcD3fHT5cWKb0AQjkSbw9FcXjxqs4Vv+Tlw1pvP3+Y+HolZeiJPhcnfsca/j9e3XE0X237eHDhRXn9hEm5Emcq8Mvh21XcXQ7OsPCNC4H/4jBzNFrL0VHcIjHUy7Mku/z9uT+5o9ffrSHDxeWuRycYHkSYb9tVxEeEBg9dFUa5/Bs0MzRqy9FR3CrSnBs9WfZHj5cWD7++PU/lWB5Em+/vfb+E/FX0QqWpXEunn0gspmjV1+KkmD/JU1FS5unrK6+OXy4sObUrg6WJ3H+8tfBtwS2XEVTRIvTCIKnj159KTqCQ+UQXQn7Q6vvtj18uLB0uCu6nGB5EkdXOrosuOEq2iaQOA2vbubo1ZeSm+Bz08YS/n9cCL6Ngh/qvLFFcFUMVQXshj/VzAWLi+gQQk9eIvn9thXRoV6r6rgN5eKtqjRaREsbWXW8Ynmb4lg/XPkiTyJ8adUXuKFl0+YvcRqZN7Jk3aQ2FuamblLIwfIkQkzd86ZuUvj6t6RxzrubJBvocJVW73DJQEcYyZIncWz+PjZcRVMHi9M45z3Q4cvK6CZWXb6649rDhwvLhKFKeRLnZsB0w1WUG9Ooa9eZo1deCjcbjINg4yDYOAg2DoKNg2DjINg4CDYOgo2DYOMg2DgINg6CjYNg4yDYOAg2DoKNg2DjINg4CDYOgo2DYOMg2DgINg6CjYNg4yDYOLsWHB4E7HF+uW07T79Ks9o0evhkumPrJ1PIB3OCu+tmvn+Rmh34HIDgjefLnf0LLuuYci4+nXuyv/Bx0Ny2evkYnuS8fPvDhVcJu/tN/wuPetebD/881MHpfLrdz+HJ1sdq3T+ewrr6pMMds2P3gt1D7i5uin+o/ly8NLksfPcvzcbn6oMT3+zebnbBjlxcu8uhWhsCsNQbb5/rI57bdfepdHbMj70Lvnx7DRETmngkfcGVl6t/ntovtLs3m0MohPPDq98cQi/cjms/P1/b39W6Xiq3HTNk74Ldr3Phc2Ew3Bccwhw4K00FWu8e/gUzzeZ6nzZ7158bfd11d6lkXDvvXnBVO3750wnwoWpfhoKbuDthQ7P7vWBXFMwJrqMbtuv6qSBYB9+QeukUkKUrasdycL3i2u6+KQcPUkGwDtXXGiLCNY3YJideu3XwbVsTQK4YrYOnBd/q4Jf7kyJYlzozXQ5NfMumsXTtNJR8A7fJ2u3ublOvFT0t2Kfx/v2xm4PrVBCsSV0dPryWPrhriCtUtv3getn1Yass19bBYfdy0A+eEdz2g1/uT4pg+GwQbBwEGwfBxkGwcRBsHAQbB8HGQbBxEGwcBBsHwcZBsHEQbBwEGwfBxkGwcRBsHAQbB8HGQbBxEGwcBBsHwcb5P9tApU0nvZYSAAAAAElFTkSuQmCC" /><!-- --></p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
