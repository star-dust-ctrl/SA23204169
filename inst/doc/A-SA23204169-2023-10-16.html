<!DOCTYPE html>

<html>

<head>

<meta charset="utf-8" />
<meta name="generator" content="pandoc" />
<meta http-equiv="X-UA-Compatible" content="IE=EDGE" />

<meta name="viewport" content="width=device-width, initial-scale=1" />

<meta name="author" content="Huiyang Peng" />

<meta name="date" content="2023-10-16" />

<title>Homework-2023.10.16</title>

<script>// Pandoc 2.9 adds attributes on both header and div. We remove the former (to
// be compatible with the behavior of Pandoc < 2.8).
document.addEventListener('DOMContentLoaded', function(e) {
  var hs = document.querySelectorAll("div.section[class*='level'] > :first-child");
  var i, h, a;
  for (i = 0; i < hs.length; i++) {
    h = hs[i];
    if (!/^h[1-6]$/i.test(h.tagName)) continue;  // it should be a header h1-h6
    a = h.attributes;
    while (a.length > 0) h.removeAttribute(a[0].name);
  }
});
</script>

<style type="text/css">
code{white-space: pre-wrap;}
span.smallcaps{font-variant: small-caps;}
span.underline{text-decoration: underline;}
div.column{display: inline-block; vertical-align: top; width: 50%;}
div.hanging-indent{margin-left: 1.5em; text-indent: -1.5em;}
ul.task-list{list-style: none;}
</style>



<style type="text/css">
code {
white-space: pre;
}
.sourceCode {
overflow: visible;
}
</style>
<style type="text/css" data-origin="pandoc">
pre > code.sourceCode { white-space: pre; position: relative; }
pre > code.sourceCode > span { display: inline-block; line-height: 1.25; }
pre > code.sourceCode > span:empty { height: 1.2em; }
.sourceCode { overflow: visible; }
code.sourceCode > span { color: inherit; text-decoration: inherit; }
div.sourceCode { margin: 1em 0; }
pre.sourceCode { margin: 0; }
@media screen {
div.sourceCode { overflow: auto; }
}
@media print {
pre > code.sourceCode { white-space: pre-wrap; }
pre > code.sourceCode > span { text-indent: -5em; padding-left: 5em; }
}
pre.numberSource code
{ counter-reset: source-line 0; }
pre.numberSource code > span
{ position: relative; left: -4em; counter-increment: source-line; }
pre.numberSource code > span > a:first-child::before
{ content: counter(source-line);
position: relative; left: -1em; text-align: right; vertical-align: baseline;
border: none; display: inline-block;
-webkit-touch-callout: none; -webkit-user-select: none;
-khtml-user-select: none; -moz-user-select: none;
-ms-user-select: none; user-select: none;
padding: 0 4px; width: 4em;
color: #aaaaaa;
}
pre.numberSource { margin-left: 3em; border-left: 1px solid #aaaaaa; padding-left: 4px; }
div.sourceCode
{ }
@media screen {
pre > code.sourceCode > span > a:first-child::before { text-decoration: underline; }
}
code span.al { color: #ff0000; font-weight: bold; } 
code span.an { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.at { color: #7d9029; } 
code span.bn { color: #40a070; } 
code span.bu { color: #008000; } 
code span.cf { color: #007020; font-weight: bold; } 
code span.ch { color: #4070a0; } 
code span.cn { color: #880000; } 
code span.co { color: #60a0b0; font-style: italic; } 
code span.cv { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.do { color: #ba2121; font-style: italic; } 
code span.dt { color: #902000; } 
code span.dv { color: #40a070; } 
code span.er { color: #ff0000; font-weight: bold; } 
code span.ex { } 
code span.fl { color: #40a070; } 
code span.fu { color: #06287e; } 
code span.im { color: #008000; font-weight: bold; } 
code span.in { color: #60a0b0; font-weight: bold; font-style: italic; } 
code span.kw { color: #007020; font-weight: bold; } 
code span.op { color: #666666; } 
code span.ot { color: #007020; } 
code span.pp { color: #bc7a00; } 
code span.sc { color: #4070a0; } 
code span.ss { color: #bb6688; } 
code span.st { color: #4070a0; } 
code span.va { color: #19177c; } 
code span.vs { color: #4070a0; } 
code span.wa { color: #60a0b0; font-weight: bold; font-style: italic; } 
</style>
<script>
// apply pandoc div.sourceCode style to pre.sourceCode instead
(function() {
  var sheets = document.styleSheets;
  for (var i = 0; i < sheets.length; i++) {
    if (sheets[i].ownerNode.dataset["origin"] !== "pandoc") continue;
    try { var rules = sheets[i].cssRules; } catch (e) { continue; }
    var j = 0;
    while (j < rules.length) {
      var rule = rules[j];
      // check if there is a div.sourceCode rule
      if (rule.type !== rule.STYLE_RULE || rule.selectorText !== "div.sourceCode") {
        j++;
        continue;
      }
      var style = rule.style.cssText;
      // check if color or background-color is set
      if (rule.style.color === '' && rule.style.backgroundColor === '') {
        j++;
        continue;
      }
      // replace div.sourceCode by a pre.sourceCode rule
      sheets[i].deleteRule(j);
      sheets[i].insertRule('pre.sourceCode{' + style + '}', j);
    }
  }
})();
</script>




<style type="text/css">body {
background-color: #fff;
margin: 1em auto;
max-width: 700px;
overflow: visible;
padding-left: 2em;
padding-right: 2em;
font-family: "Open Sans", "Helvetica Neue", Helvetica, Arial, sans-serif;
font-size: 14px;
line-height: 1.35;
}
#TOC {
clear: both;
margin: 0 0 10px 10px;
padding: 4px;
width: 400px;
border: 1px solid #CCCCCC;
border-radius: 5px;
background-color: #f6f6f6;
font-size: 13px;
line-height: 1.3;
}
#TOC .toctitle {
font-weight: bold;
font-size: 15px;
margin-left: 5px;
}
#TOC ul {
padding-left: 40px;
margin-left: -1.5em;
margin-top: 5px;
margin-bottom: 5px;
}
#TOC ul ul {
margin-left: -2em;
}
#TOC li {
line-height: 16px;
}
table {
margin: 1em auto;
border-width: 1px;
border-color: #DDDDDD;
border-style: outset;
border-collapse: collapse;
}
table th {
border-width: 2px;
padding: 5px;
border-style: inset;
}
table td {
border-width: 1px;
border-style: inset;
line-height: 18px;
padding: 5px 5px;
}
table, table th, table td {
border-left-style: none;
border-right-style: none;
}
table thead, table tr.even {
background-color: #f7f7f7;
}
p {
margin: 0.5em 0;
}
blockquote {
background-color: #f6f6f6;
padding: 0.25em 0.75em;
}
hr {
border-style: solid;
border: none;
border-top: 1px solid #777;
margin: 28px 0;
}
dl {
margin-left: 0;
}
dl dd {
margin-bottom: 13px;
margin-left: 13px;
}
dl dt {
font-weight: bold;
}
ul {
margin-top: 0;
}
ul li {
list-style: circle outside;
}
ul ul {
margin-bottom: 0;
}
pre, code {
background-color: #f7f7f7;
border-radius: 3px;
color: #333;
white-space: pre-wrap; 
}
pre {
border-radius: 3px;
margin: 5px 0px 10px 0px;
padding: 10px;
}
pre:not([class]) {
background-color: #f7f7f7;
}
code {
font-family: Consolas, Monaco, 'Courier New', monospace;
font-size: 85%;
}
p > code, li > code {
padding: 2px 0px;
}
div.figure {
text-align: center;
}
img {
background-color: #FFFFFF;
padding: 2px;
border: 1px solid #DDDDDD;
border-radius: 3px;
border: 1px solid #CCCCCC;
margin: 0 5px;
}
h1 {
margin-top: 0;
font-size: 35px;
line-height: 40px;
}
h2 {
border-bottom: 4px solid #f7f7f7;
padding-top: 10px;
padding-bottom: 2px;
font-size: 145%;
}
h3 {
border-bottom: 2px solid #f7f7f7;
padding-top: 10px;
font-size: 120%;
}
h4 {
border-bottom: 1px solid #f7f7f7;
margin-left: 8px;
font-size: 105%;
}
h5, h6 {
border-bottom: 1px solid #ccc;
font-size: 105%;
}
a {
color: #0033dd;
text-decoration: none;
}
a:hover {
color: #6666ff; }
a:visited {
color: #800080; }
a:visited:hover {
color: #BB00BB; }
a[href^="http:"] {
text-decoration: underline; }
a[href^="https:"] {
text-decoration: underline; }

code > span.kw { color: #555; font-weight: bold; } 
code > span.dt { color: #902000; } 
code > span.dv { color: #40a070; } 
code > span.bn { color: #d14; } 
code > span.fl { color: #d14; } 
code > span.ch { color: #d14; } 
code > span.st { color: #d14; } 
code > span.co { color: #888888; font-style: italic; } 
code > span.ot { color: #007020; } 
code > span.al { color: #ff0000; font-weight: bold; } 
code > span.fu { color: #900; font-weight: bold; } 
code > span.er { color: #a61717; background-color: #e3d2d2; } 
</style>




</head>

<body>




<h1 class="title toc-ignore">Homework-2023.10.16</h1>
<h4 class="author">Huiyang Peng</h4>
<h4 class="date">2023-10-16</h4>



<div id="class-homework" class="section level1">
<h1>1.Class Homework</h1>
<div id="restate" class="section level2">
<h2>Restate</h2>
<p>现有<span class="math inline">\(m=1000\)</span>个假设，其中95%原假设成立，5%对立假设成立，在原假设下<span class="math inline">\(P\sim U(0,1)\)</span>，在对立假设下<span class="math inline">\(P\sim Beta(0.1,1)\)</span>。对生成的<span class="math inline">\(m\)</span>个<span class="math inline">\(P\)</span>值应用Bonferroni校正和B-H校正得到校正后的<span class="math inline">\(P\)</span>值，与<span class="math inline">\(\alpha=0.1\)</span>比较确定是否拒绝原假设，基于<span class="math inline">\(M=1000\)</span>次模拟，估计<span class="math inline">\(FWER,FDR,TPR\)</span>。</p>
</div>
<div id="code" class="section level2">
<h2>Code</h2>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb1-1"><a href="#cb1-1" tabindex="-1"></a>M <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb1-2"><a href="#cb1-2" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb1-3"><a href="#cb1-3" tabindex="-1"></a>m1 <span class="ot">=</span> m <span class="sc">*</span> <span class="fl">0.95</span></span>
<span id="cb1-4"><a href="#cb1-4" tabindex="-1"></a>m2 <span class="ot">=</span> m <span class="sc">*</span> <span class="fl">0.05</span></span>
<span id="cb1-5"><a href="#cb1-5" tabindex="-1"></a>alpha <span class="ot">=</span> <span class="fl">0.1</span></span>
<span id="cb1-6"><a href="#cb1-6" tabindex="-1"></a>bon.FWER <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-7"><a href="#cb1-7" tabindex="-1"></a>bon.V  <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-8"><a href="#cb1-8" tabindex="-1"></a>bon.S <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-9"><a href="#cb1-9" tabindex="-1"></a>bon.T <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-10"><a href="#cb1-10" tabindex="-1"></a>BH.FWER <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-11"><a href="#cb1-11" tabindex="-1"></a>BH.V  <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-12"><a href="#cb1-12" tabindex="-1"></a>BH.S <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-13"><a href="#cb1-13" tabindex="-1"></a>BH.T <span class="ot">&lt;-</span> <span class="dv">0</span></span>
<span id="cb1-14"><a href="#cb1-14" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb1-15"><a href="#cb1-15" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>M) {</span>
<span id="cb1-16"><a href="#cb1-16" tabindex="-1"></a>  p1 <span class="ot">&lt;-</span> <span class="fu">runif</span>(m1)</span>
<span id="cb1-17"><a href="#cb1-17" tabindex="-1"></a>  p2 <span class="ot">&lt;-</span> <span class="fu">rbeta</span>(m2, <span class="fl">0.1</span>, <span class="dv">1</span>)</span>
<span id="cb1-18"><a href="#cb1-18" tabindex="-1"></a>  p <span class="ot">&lt;-</span> <span class="fu">c</span>(p1, p2)</span>
<span id="cb1-19"><a href="#cb1-19" tabindex="-1"></a>  p.bonferroni <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&quot;bonferroni&quot;</span>)</span>
<span id="cb1-20"><a href="#cb1-20" tabindex="-1"></a>  p.BH <span class="ot">&lt;-</span> <span class="fu">p.adjust</span>(p, <span class="at">method =</span> <span class="st">&quot;BH&quot;</span>)</span>
<span id="cb1-21"><a href="#cb1-21" tabindex="-1"></a>  bon.FWER <span class="ot">&lt;-</span> bon.FWER <span class="sc">+</span> (<span class="fu">any</span>(p.bonferroni[<span class="dv">1</span><span class="sc">:</span>m1] <span class="sc">&lt;=</span> alpha))<span class="sc">/</span>M</span>
<span id="cb1-22"><a href="#cb1-22" tabindex="-1"></a>  bon.V <span class="ot">&lt;-</span> bon.V <span class="sc">+</span> <span class="fu">sum</span>((p.bonferroni[<span class="dv">1</span><span class="sc">:</span>m1] <span class="sc">&lt;=</span> alpha))</span>
<span id="cb1-23"><a href="#cb1-23" tabindex="-1"></a>  bon.S <span class="ot">&lt;-</span> bon.S <span class="sc">+</span> <span class="fu">sum</span>((p.bonferroni[(m1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m] <span class="sc">&lt;=</span> alpha))</span>
<span id="cb1-24"><a href="#cb1-24" tabindex="-1"></a>  bon.T <span class="ot">&lt;-</span> bon.T <span class="sc">+</span> <span class="fu">sum</span>((p.bonferroni[(m1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m] <span class="sc">&gt;</span> alpha))</span>
<span id="cb1-25"><a href="#cb1-25" tabindex="-1"></a>  BH.FWER <span class="ot">&lt;-</span> BH.FWER <span class="sc">+</span> (<span class="fu">any</span>(p.BH[<span class="dv">1</span><span class="sc">:</span>m1] <span class="sc">&lt;=</span> alpha))<span class="sc">/</span>M</span>
<span id="cb1-26"><a href="#cb1-26" tabindex="-1"></a>  BH.V <span class="ot">&lt;-</span> BH.V <span class="sc">+</span> <span class="fu">sum</span>((p.BH[<span class="dv">1</span><span class="sc">:</span>m1] <span class="sc">&lt;=</span> alpha))</span>
<span id="cb1-27"><a href="#cb1-27" tabindex="-1"></a>  BH.S <span class="ot">&lt;-</span> BH.S <span class="sc">+</span> <span class="fu">sum</span>((p.BH[(m1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m] <span class="sc">&lt;=</span> alpha))</span>
<span id="cb1-28"><a href="#cb1-28" tabindex="-1"></a>  BH.T <span class="ot">&lt;-</span> BH.T <span class="sc">+</span> <span class="fu">sum</span>((p.BH[(m1<span class="sc">+</span><span class="dv">1</span>)<span class="sc">:</span>m] <span class="sc">&gt;</span> alpha))</span>
<span id="cb1-29"><a href="#cb1-29" tabindex="-1"></a>}</span>
<span id="cb1-30"><a href="#cb1-30" tabindex="-1"></a>bon.FDR <span class="ot">&lt;-</span> bon.V<span class="sc">/</span>(bon.V <span class="sc">+</span> bon.S) </span>
<span id="cb1-31"><a href="#cb1-31" tabindex="-1"></a>bon.TPR <span class="ot">&lt;-</span> bon.S<span class="sc">/</span>(bon.T <span class="sc">+</span> bon.S)</span>
<span id="cb1-32"><a href="#cb1-32" tabindex="-1"></a>BH.FDR <span class="ot">&lt;-</span> BH.V<span class="sc">/</span>(BH.V <span class="sc">+</span> BH.S) </span>
<span id="cb1-33"><a href="#cb1-33" tabindex="-1"></a>BH.TPR <span class="ot">&lt;-</span> BH.S<span class="sc">/</span>(BH.T <span class="sc">+</span> BH.S)</span>
<span id="cb1-34"><a href="#cb1-34" tabindex="-1"></a>result <span class="ot">&lt;-</span> <span class="fu">data.frame</span>(<span class="at">Method =</span> <span class="fu">c</span>(<span class="st">&quot;Bonferroni&quot;</span>,<span class="st">&quot;BH&quot;</span>), <span class="at">FWER =</span> <span class="fu">c</span>(bon.FWER,BH.FWER), <span class="at">FDR =</span> <span class="fu">c</span>(bon.FDR,BH.FDR), <span class="at">TPR =</span> <span class="fu">c</span>(bon.TPR, BH.TPR))</span>
<span id="cb1-35"><a href="#cb1-35" tabindex="-1"></a>knitr<span class="sc">::</span><span class="fu">kable</span>(result)</span></code></pre></div>
<table>
<thead>
<tr class="header">
<th align="left">Method</th>
<th align="right">FWER</th>
<th align="right">FDR</th>
<th align="right">TPR</th>
</tr>
</thead>
<tbody>
<tr class="odd">
<td align="left">Bonferroni</td>
<td align="right">0.087</td>
<td align="right">0.0046389</td>
<td align="right">0.3991</td>
</tr>
<tr class="even">
<td align="left">BH</td>
<td align="right">0.923</td>
<td align="right">0.0981819</td>
<td align="right">0.5625</td>
</tr>
</tbody>
</table>
</div>
</div>
<div id="class-homework-1" class="section level1">
<h1>2.Class Homework</h1>
<div id="restate-1" class="section level2">
<h2>Restate</h2>
<p>假设总体为参数为<span class="math inline">\(\lambda\)</span>的指数分布，那么<span class="math inline">\(\hat{\lambda}=1/\bar{X}\)</span>是一个极大似然估计。可以得到<span class="math inline">\(\hat{\lambda}\)</span>的期望是<span class="math inline">\(\lambda n/(n-1)\)</span>，因此估计偏差为<span class="math inline">\(\lambda/(n-1)\)</span>，估计标准差为<span class="math inline">\(\lambda
n/[(n-1)\sqrt{n-2}]\)</span>。进行模拟实验来观察bootstrap方法的表现。</p>
<p>参数如下：指数分布<span class="math inline">\(\lambda=2\)</span>，样本量<span class="math inline">\(n=5,10,20\)</span>，Bootstrap方法内重复<span class="math inline">\(B=1000\)</span>，模拟重复<span class="math inline">\(m=1000\)</span>，将bootstrap方法得到的偏差和标准差与理论结果做对比，评价该结果。</p>
</div>
<div id="code-1" class="section level2">
<h2>Code</h2>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb2-1"><a href="#cb2-1" tabindex="-1"></a>lambda <span class="ot">=</span> <span class="dv">2</span></span>
<span id="cb2-2"><a href="#cb2-2" tabindex="-1"></a>B <span class="ot">=</span> <span class="dv">1000</span></span>
<span id="cb2-3"><a href="#cb2-3" tabindex="-1"></a>m <span class="ot">=</span> <span class="dv">1000</span></span></code></pre></div>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb3-1"><a href="#cb3-1" tabindex="-1"></a><span class="co"># n = 5</span></span>
<span id="cb3-2"><a href="#cb3-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">5</span></span>
<span id="cb3-3"><a href="#cb3-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb3-4"><a href="#cb3-4" tabindex="-1"></a>bias.r <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb3-5"><a href="#cb3-5" tabindex="-1"></a>sd.r <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb3-6"><a href="#cb3-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb3-7"><a href="#cb3-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, lambda)</span>
<span id="cb3-8"><a href="#cb3-8" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb3-9"><a href="#cb3-9" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb3-10"><a href="#cb3-10" tabindex="-1"></a>    x.sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb3-11"><a href="#cb3-11" tabindex="-1"></a>    temp[j] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x.sample)</span>
<span id="cb3-12"><a href="#cb3-12" tabindex="-1"></a>  }</span>
<span id="cb3-13"><a href="#cb3-13" tabindex="-1"></a>  bias.r[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp) <span class="sc">-</span> lambda</span>
<span id="cb3-14"><a href="#cb3-14" tabindex="-1"></a>  sd.r[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(temp)</span>
<span id="cb3-15"><a href="#cb3-15" tabindex="-1"></a>}</span>
<span id="cb3-16"><a href="#cb3-16" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb3-17"><a href="#cb3-17" tabindex="-1"></a><span class="fu">hist</span>(bias.r,<span class="at">breaks =</span> <span class="dv">30</span>);<span class="fu">abline</span>(<span class="at">v=</span>lambda<span class="sc">/</span>(n<span class="dv">-1</span>),<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb3-18"><a href="#cb3-18" tabindex="-1"></a><span class="fu">hist</span>(sd.r, <span class="at">breaks =</span> <span class="dv">30</span>);<span class="fu">abline</span>(<span class="at">v=</span>lambda <span class="sc">*</span> n<span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>)),<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb4-1"><a href="#cb4-1" tabindex="-1"></a><span class="co"># n = 10</span></span>
<span id="cb4-2"><a href="#cb4-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">10</span></span>
<span id="cb4-3"><a href="#cb4-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb4-4"><a href="#cb4-4" tabindex="-1"></a>bias.r <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb4-5"><a href="#cb4-5" tabindex="-1"></a>sd.r <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb4-6"><a href="#cb4-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb4-7"><a href="#cb4-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, lambda)</span>
<span id="cb4-8"><a href="#cb4-8" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb4-9"><a href="#cb4-9" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb4-10"><a href="#cb4-10" tabindex="-1"></a>    x.sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb4-11"><a href="#cb4-11" tabindex="-1"></a>    temp[j] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x.sample)</span>
<span id="cb4-12"><a href="#cb4-12" tabindex="-1"></a>  }</span>
<span id="cb4-13"><a href="#cb4-13" tabindex="-1"></a>  bias.r[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp) <span class="sc">-</span> lambda</span>
<span id="cb4-14"><a href="#cb4-14" tabindex="-1"></a>  sd.r[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(temp)</span>
<span id="cb4-15"><a href="#cb4-15" tabindex="-1"></a>}</span>
<span id="cb4-16"><a href="#cb4-16" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb4-17"><a href="#cb4-17" tabindex="-1"></a><span class="fu">hist</span>(bias.r,<span class="at">breaks =</span> <span class="dv">30</span>);<span class="fu">abline</span>(<span class="at">v=</span>lambda<span class="sc">/</span>(n<span class="dv">-1</span>),<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb4-18"><a href="#cb4-18" tabindex="-1"></a><span class="fu">hist</span>(sd.r, <span class="at">breaks =</span> <span class="dv">30</span>);<span class="fu">abline</span>(<span class="at">v=</span>lambda <span class="sc">*</span> n<span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>)),<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
<div class="sourceCode" id="cb5"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb5-1"><a href="#cb5-1" tabindex="-1"></a><span class="co"># n = 20</span></span>
<span id="cb5-2"><a href="#cb5-2" tabindex="-1"></a>n <span class="ot">=</span> <span class="dv">20</span></span>
<span id="cb5-3"><a href="#cb5-3" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb5-4"><a href="#cb5-4" tabindex="-1"></a>bias.r <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb5-5"><a href="#cb5-5" tabindex="-1"></a>sd.r <span class="ot">&lt;-</span> <span class="fu">numeric</span>(m)</span>
<span id="cb5-6"><a href="#cb5-6" tabindex="-1"></a><span class="cf">for</span> (i <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>m) {</span>
<span id="cb5-7"><a href="#cb5-7" tabindex="-1"></a>  x <span class="ot">&lt;-</span> <span class="fu">rexp</span>(n, lambda)</span>
<span id="cb5-8"><a href="#cb5-8" tabindex="-1"></a>  temp <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb5-9"><a href="#cb5-9" tabindex="-1"></a>  <span class="cf">for</span> (j <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb5-10"><a href="#cb5-10" tabindex="-1"></a>    x.sample <span class="ot">&lt;-</span> <span class="fu">sample</span>(x, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb5-11"><a href="#cb5-11" tabindex="-1"></a>    temp[j] <span class="ot">&lt;-</span> <span class="dv">1</span><span class="sc">/</span><span class="fu">mean</span>(x.sample)</span>
<span id="cb5-12"><a href="#cb5-12" tabindex="-1"></a>  }</span>
<span id="cb5-13"><a href="#cb5-13" tabindex="-1"></a>  bias.r[i] <span class="ot">&lt;-</span> <span class="fu">mean</span>(temp) <span class="sc">-</span> lambda</span>
<span id="cb5-14"><a href="#cb5-14" tabindex="-1"></a>  sd.r[i] <span class="ot">&lt;-</span> <span class="fu">sd</span>(temp)</span>
<span id="cb5-15"><a href="#cb5-15" tabindex="-1"></a>}</span>
<span id="cb5-16"><a href="#cb5-16" tabindex="-1"></a><span class="fu">par</span>(<span class="at">mfrow =</span> <span class="fu">c</span>(<span class="dv">2</span>,<span class="dv">1</span>))</span>
<span id="cb5-17"><a href="#cb5-17" tabindex="-1"></a><span class="fu">hist</span>(bias.r,<span class="at">breaks =</span> <span class="dv">30</span>);<span class="fu">abline</span>(<span class="at">v=</span>lambda<span class="sc">/</span>(n<span class="dv">-1</span>),<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span>
<span id="cb5-18"><a href="#cb5-18" tabindex="-1"></a><span class="fu">hist</span>(sd.r, <span class="at">breaks =</span> <span class="dv">30</span>);<span class="fu">abline</span>(<span class="at">v=</span>lambda <span class="sc">*</span> n<span class="sc">/</span>((n<span class="dv">-1</span>)<span class="sc">*</span><span class="fu">sqrt</span>(n<span class="dv">-2</span>)),<span class="at">col=</span><span class="st">&#39;red&#39;</span>,<span class="at">lwd=</span><span class="dv">2</span>)</span></code></pre></div>
<p><img src="data:image/png;base64,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" /><!-- --></p>
</div>
<div id="评价结果" class="section level2">
<h2>评价结果</h2>
<p>可以看出，样本数较少时，bootstrap方法所得到的均值和方差值分布都较为分散，且估计效果不好，与理论偏差相差较大。随着样本数增加，bootstrap方法所得估计与理论偏差接近，方差减小。</p>
</div>
</div>
<div id="exercise-7.3" class="section level1">
<h1>3.Exercise 7.3</h1>
<div id="restate-2" class="section level2">
<h2>Restate</h2>
<p>用Bootstrap方法得到Example 7.2中相关性统计量的一个bootstrap
t置信区间。</p>
</div>
<div id="code-2" class="section level2">
<h2>Code</h2>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><span id="cb6-1"><a href="#cb6-1" tabindex="-1"></a><span class="fu">library</span>(bootstrap)</span>
<span id="cb6-2"><a href="#cb6-2" tabindex="-1"></a>B <span class="ot">&lt;-</span> <span class="dv">200</span></span>
<span id="cb6-3"><a href="#cb6-3" tabindex="-1"></a>n <span class="ot">&lt;-</span> <span class="fu">nrow</span>(law)</span>
<span id="cb6-4"><a href="#cb6-4" tabindex="-1"></a>R <span class="ot">&lt;-</span> <span class="fu">numeric</span>(B)</span>
<span id="cb6-5"><a href="#cb6-5" tabindex="-1"></a><span class="fu">set.seed</span>(<span class="dv">0</span>)</span>
<span id="cb6-6"><a href="#cb6-6" tabindex="-1"></a><span class="cf">for</span> (b <span class="cf">in</span> <span class="dv">1</span><span class="sc">:</span>B) {</span>
<span id="cb6-7"><a href="#cb6-7" tabindex="-1"></a>  i <span class="ot">&lt;-</span> <span class="fu">sample</span>(<span class="dv">1</span><span class="sc">:</span>n, <span class="at">size =</span> n, <span class="at">replace =</span> <span class="cn">TRUE</span>)</span>
<span id="cb6-8"><a href="#cb6-8" tabindex="-1"></a>  LSAT <span class="ot">&lt;-</span> law<span class="sc">$</span>LSAT[i]</span>
<span id="cb6-9"><a href="#cb6-9" tabindex="-1"></a>  GPA <span class="ot">&lt;-</span> law<span class="sc">$</span>GPA[i]</span>
<span id="cb6-10"><a href="#cb6-10" tabindex="-1"></a>  R[b] <span class="ot">&lt;-</span> <span class="fu">cor</span>(LSAT, GPA)</span>
<span id="cb6-11"><a href="#cb6-11" tabindex="-1"></a>}</span>
<span id="cb6-12"><a href="#cb6-12" tabindex="-1"></a>mean.R <span class="ot">&lt;-</span> <span class="fu">mean</span>(R)</span>
<span id="cb6-13"><a href="#cb6-13" tabindex="-1"></a>se.R <span class="ot">&lt;-</span> <span class="fu">sd</span>(R)</span>
<span id="cb6-14"><a href="#cb6-14" tabindex="-1"></a>t <span class="ot">&lt;-</span> <span class="fu">qt</span>(<span class="at">p =</span> <span class="fl">0.975</span>, <span class="at">df =</span> n<span class="dv">-1</span>)</span>
<span id="cb6-15"><a href="#cb6-15" tabindex="-1"></a><span class="fu">cat</span>(<span class="st">&quot;The bootstrap t confidence interval for correlation statistic is [&quot;</span>, </span>
<span id="cb6-16"><a href="#cb6-16" tabindex="-1"></a>    mean.R <span class="sc">-</span> t <span class="sc">*</span> se.R, <span class="st">&quot;,&quot;</span>, mean.R <span class="sc">+</span> t <span class="sc">*</span> se.R, <span class="st">&quot;]&quot;</span>)</span></code></pre></div>
<pre><code>## The bootstrap t confidence interval for correlation statistic is [ 0.515 , 1.065972 ]</code></pre>
<p>由于<span class="math inline">\(0\le R\le
1\)</span>，所以也可以将该置信区间写作<span class="math inline">\([0.515
, 1]\)</span>。</p>
</div>
</div>



<!-- code folding -->


<!-- dynamically load mathjax for compatibility with self-contained -->
<script>
  (function () {
    var script = document.createElement("script");
    script.type = "text/javascript";
    script.src  = "https://mathjax.rstudio.com/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML";
    document.getElementsByTagName("head")[0].appendChild(script);
  })();
</script>

</body>
</html>
